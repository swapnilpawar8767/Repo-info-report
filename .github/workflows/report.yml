name: Daily GitHub Repo Report

on:
  workflow_dispatch:

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup GitHub CLI
        uses: cli/cli-action@v2

      - name: Generate Report
        run: |
          echo "# ðŸ“Š Daily GitHub Repo Report ðŸ“Š" > report.md
          echo "" >> report.md
          echo "ðŸ—“ Date: $(date '+%Y-%m-%d %H:%M:%S')" >> report.md
          echo "" >> report.md
          echo "## Recent Commits" >> report.md
          echo "" >> report.md
          
          # Get last 5 commits in test-style format
          gh api repos/{owner}/{repo}/commits \
            --paginate \
            -q '.[] | "- Author: \(.commit.author.name)\n  Message: \(.commit.message)\n  SHA: \(.sha)\n  URL: \(.html_url)\n"' \
            | head -n 20 >> report.md
          
          echo "" >> report.md
          echo "---" >> report.md
          echo "_End of Report_" >> report.md

      - name: Upload Artifact (for testing)
        uses: actions/upload-artifact@v4
        with:
          name: daily-report
          path: report.md
